<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>管理</title>
    <style>
        ul {
            color: white;
            list-style: none;
        }
        
        li {
            padding: 1rem;
        }
        
        th {
            font-weight: normal;
            height: 50px;
            text-align: center;
            font-weight: 800;
        }
        
        td {
            height: 75px;
            text-align: center;
        }
        
        .slid {
            background-color: #0C72B8;
            margin-top: 2px;
        }
        
        .selected {
            background-color: #144B7A;
        }
        
        .trhead {
            height: 50px;
        }
        
        thead {
            color: green;
        }
        
        tbody {
            color: blue;
        }
        
        tfoot {
            color: red;
        }
    </style>
</head>

<body>
    <div class="container" style="width: 100%">
        <div class="row">
            <div class="col-xs-3">
                <div class="slid">
                    <ul style="padding: 0px;">
                        <li>产品管理</li>
                        <li class="selected">用户管理</li>
                        <li>信息管理</li>
                        <li>报修管理</li>
                        <li>资讯管理</li>
                        <li>机器人聊天管理</li>
                        <li>优惠券管理</li>
                        <li>服务类型管理</li>
                    </ul>
                </div>
            </div>

            <div class="col-xs-9">
                <div class="main">
                    <div style="margin: 1rem;">当前位置 : <span> 公众号管理 ></span><span id="listname"></span>
                    </div>
                    <div>
                        <select style="padding: 3px; height: 2rem;">
                            <option>昵称</option>
                        <option>联系人</option>
                        <option>序号</option>
                        <option>注册电话</option>
                        <option>品牌</option>
                    </select>
                        <input id="search" style="margin-bottom: 1rem">&#12288;&#12288;</input>
                        <button id="searchbtn" style="background-color:#0C72B8;color: white;    border: none; border-radius: 5px;">查询</button>
                        <button data-toggle="modal" data-target="#myModal" id="new" style="background-color:#0C72B8;color: white;  float: right;  border: none; border-radius: 5px;">添加</button>
                    </div>
                    <div>
                        <table border="1" style="width: 100%" id="people">
                            <tbody></tbody>

                            <tr class="trhead" id="show_tab_one">
                                <th>序号</th>
                                <th>联系人</th>
                                <th>昵称</th>
                                <th>注册电话</th>
                                <th style="width: 165px;">联系地址</th>
                                <th>条码</th>
                                <th>品牌</th>
                                <th>型号</th>
                                <th>操作</th>
                            </tr>


                            <tr>
                                <td>1</td>
                                <td>瓶子</td>
                                <td>阿斯加德1</td>
                                <td>12345678909</td>
                                <td>西安市雁塔区金辉世界城A区 4号楼 2单元1209</td>
                                <td>1234567890</td>
                                <td>达大厦</td>
                                <td>123klkj</td>
                                <td><a class="up">上移</a>&#12288;<a class="down">下移</a>&#12288;<a class="top">置顶</a>&#12288;
                                    <a class="edit">修改</a>&#12288;<a class="del">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>瓶子</td>
                                <td>阿斯加德4</td>
                                <td>12345678909</td>
                                <td>西安市雁塔区金辉世界城A区 4号楼 2单元1209</td>
                                <td>1234567890</td>
                                <td>达大厦</td>
                                <td>123klkj</td>
                                <td><a class="up">上移</a>&#12288;<a class="down">下移</a>&#12288;<a class="top">置顶</a>&#12288;
                                    <a class="edit">修改</a>&#12288;<a class="del">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>瓶子</td>
                                <td>阿斯加德2</td>
                                <td>12345678909</td>
                                <td>西安市雁塔区金辉世界城A区 4号楼 2单元1209</td>
                                <td>1234567890</td>
                                <td>达大厦</td>
                                <td>123klkj</td>
                                <td><a class="up">上移</a>&#12288;<a class="down">下移</a>&#12288;<a class="top">置顶</a>&#12288;
                                    <a class="edit">修改</a>&#12288;<a class="del">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>瓶子</td>
                                <td>阿斯加德4</td>
                                <td>12345678909</td>
                                <td>西安市雁塔区金辉世界城A区 4号楼 2单元1209</td>
                                <td>1234567890</td>
                                <td>达大厦</td>
                                <td>123klkj</td>
                                <td><a class="up">上移</a>&#12288;<a class="down">下移</a>&#12288;<a class="top">置顶</a>&#12288;
                                    <a class="edit">修改</a>&#12288;<a class="del">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>瓶子</td>
                                <td>阿斯加德2</td>
                                <td>12345678909</td>
                                <td>西安市雁塔区金辉世界城A区 4号楼 2单元1209</td>
                                <td>1234567890</td>
                                <td>达大厦</td>
                                <td>123klkj</td>
                                <td><a class="up">上移</a>&#12288;<a class="down">下移</a>&#12288;<a class="top">置顶</a>&#12288;
                                    <a class="edit">修改</a>&#12288;<a class="del">删除</a>
                                </td>
                            </tr>
                            </tbody>

                        </table>
                        <div class="foot" style="display: block;margin-top: 39px;">
                            <div style="display:inline-block; text-align:left;font-size: 12px;color: silver;">
                                共
                                <a id="datalen" style="color: silver"></a>条数据,共
                                <a id="page" style="color: silver"></a>页
                            </div>
                            <div style="float: right;font-size: 12px;color: silver;">
                                <input id="lastpage" type="button" value="上一页">
                                <!-- <input id="curPage" type="text" size="5"> -->
                                <input id="curPage" type="button" value="1">
                                <input id="curPage" type="button" value="2">
                                <input id="nextpage" type="button" value="下一页">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!--模态框开始 -->
    <div id="myModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">操作</h4>
                </div>
                <div class="modal-body">
                    <label>
                        <p><input type="text" id="name" placeholder="请输入姓名：" style="font-style: normal"></p>
                        <p><input type="text" id="nickname" placeholder="请输入昵称：" style="font-style: normal"></p>
                        <p><input type="text"  id="tel" placeholder="注册电话："></p>
                        <p><input type="text" id="address" placeholder="联系地址："></p>
                         <p><input type="text" id="number" placeholder="条码:"></p>
                        <p><input type="text" id="brand" placeholder="品牌:"></p>
                         <p><input type="text" id="tp" placeholder="型号:"></p>
                    </label>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary">提交</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>

    <script>
        //公众号管理>
        var name = $(".selected").text();
        $("#listname").html(name);
        //共--条数据
        len = $("#people tr").length - 1;
        $("#datalen").html(len);
        //点击获取li数据
        $(function() {
            $(".slid  li").click(function() {
                var index = $(this).index();
                var divShow = $(".content").children("div");
                /!*每个li下属的div*!/
                if (!$(this).hasClass("selected")) {

                    $($(this)).addClass("selected");
                    console.log(this);

                    $(this).add("selected");

                    $($(this)).siblings("li").removeClass("selected");
                    /!*展示当前li对应的div内容,利用方法显示和隐藏*!/
                    var name = $(".selected").text();
                    $("#listname").html(name);
                }
            });
            // 删除
            $(".main").on('click', ".del", function() {
                $(this).parent().parent().remove();
            });
            // tr上移
            $(".main").on('click', ".up", function() {
                console.log(this)
                var current = $(this).parent().parent(); //获取当前<tr>
                console.log(current.text())
                var prev = current.prev(); //获取当前<tr>前一个元素
                if (current.index() > 0) {
                    current.insertBefore(prev); //插入到当前<tr>前一个元素前
                }
            });
            // tr下移 
            $(".main").on('click', ".down", function() {
                var current = $(this).parent().parent(); //获取当前<tr>
                var next = current.next(); //获取当前<tr>后面一个元素
                if (next) {
                    current.insertAfter(next); //插入到当前<tr>后面一个元素后面
                }
            });
            //置顶
            $(".main").on('click', ".top", function() {
                console.log(this)
                var current = $(this).parent().parent();
                $('#people ').find("tr").eq(1).before(current);

            });

            //添加按钮绑定事件
            $('.my-table-tool .btn-primary').click(function() {
                $('#myModal :input').val('')
            });
            // 搜索 --声明变量
            var input, filter, table, tr, td, i;
            table = document.getElementById("people");
            $('.main #searchbtn').click(function() {
                input = document.getElementById("search");
                filter = input.value;
                tr = table.getElementsByTagName("tr");
                // 循环表格每一行，查找匹配项
                for (i = 0; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td")[2]; //列表第三项 昵称

                    if (td) {
                        if (td.innerHTML.indexOf(filter) > -1) {
                            tr[i].style.display = "";
                        } else {
                            tr[i].style.display = "none";
                        }
                    }
                }
            });
            //table分页        
            var pageSize = 7; //每页显示的记录条数   
            var curPage = 0; //显示第curPage页
            var len; //总行数
            var page; //总页数
            //共  --  页
            page = len % pageSize == 0 ? len / pageSize : Math.floor(len / pageSize) + 1; //根据记录条数，计算页数
            console.log("len:" + len + "page:" + page);
            $("#page").html(page);

            $(function() {
                len = $("#people tr").length - 1; //去掉表头     
                page = len % pageSize == 0 ? len / pageSize : Math.floor(len / pageSize) + 1; //根据记录条数，计算页数
                console.log("len:" + len + "page:" + page);
                document.getElementById("page").value = page;
                curPage = 1;
                displayPage(); //显示第一页
                $("#nextpage").click(function() { //下一页
                    if (curPage < page) {
                        curPage += 1;
                    } else {
                        alert("已到达最后一页");
                    }
                    displayPage();
                });
                $("#lastpage").click(function() { //上一页
                    if (curPage > 1) {
                        curPage -= 1;
                    } else {
                        alert("已到达第一页");
                    }
                    displayPage();
                });
                $("#npage").click(function() { //跳到固定某一页
                    var npage = parseInt(document.getElementById("curPage").value);
                    if (npage > page || npage < 1) {
                        alert("此页面不存在");
                    } else {
                        curPage = npage;
                    }
                    displayPage();
                });

            });
            if (!page) $("#page").html('1');

            function displayPage() {
                var begin = (curPage - 1) * pageSize; //起始记录号
                var end = begin + pageSize;
                console.log("  begin:" + len + "   end:" + end);
                if (end > len) end = len;
                $("#people tr").hide();
                $("#people tr").each(function(i) {
                    if (i - 1 >= begin && i - 1 < end) //显示第page页的记录
                    {
                        $("#show_tab_one").show();
                        $(this).show();
                        document.getElementById("curPage").value = curPage;
                    }
                });


            }

            function pageSize2() {
                curPage = 0; //显示第curPage页   
                pageSize = parseInt(document.getElementById("pageSize").value);
                console.log(pageSize)
                len = $("#people tr").length - 1; //去掉表头     
                page = len % pageSize == 0 ? len / pageSize : Math.floor(len / pageSize) + 1; //根据记录条数，计算页数
                console.log("len:" + len + "   page:" + page);
                document.getElementById("page").value = page;
                curPage = 1;
                displayPage(); //显示第一页   
                console.log(curPage)
            }
            //点击模态框的提交按钮
            $(".modal-footer>.btn-primary").click(function() {
                $('#myModal').modal('hide');

                //更新td的值
                //1. 取值<label>
                var name = $('#name').val();
                var nickname = $('#nickname').val();
                console.log(nickname)
                var tel = $('#tel').val();
                var address = $('#address').val();
                var brand = $('#brand').val();
                console.log(brand)
                var tp = $('#tp').val();
                var number = $('#number').val();

                //2. 赋值
                var tds = $('#myModal').data('tds');
                if (tds === undefined) {

                    //添加 1.取值,2 在表格添加一行新的tr
                    var trCreate = document.createElement('tr');
                    //第一个td是id
                    $(trCreate).append('<td>' + ($('tbody tr').length) + '</td>');

                    $(trCreate).append('<td>' + name + '</td>');
                    $(trCreate).append('<td>' + nickname + '</td>');
                    $(trCreate).append('<td>' + tel + '</td>');
                    $(trCreate).append('<td>' + address + '</td>');

                    $(trCreate).append('<td>' + number + '</td>');
                    $(trCreate).append('<td>' + brand + '</td>');
                    $(trCreate).append('<td>' + tp + '</td>');


                    $(trCreate).append($('tbody tr:first').find('td').last().clone());
                    $(trCreate).append(`<td><a class = "up">上移</a>&#12288;
                            <a class="down">下移</a> &#12288;
                            <a class= "top">置顶</a>&#12288;
                            <a class= "edit">修改</a>&#12288;
                            <a class="del">删除</a>
                        </td>`);
                    $('tbody').append(trCreate);
                } else {
                    tds.eq(1).text(name);
                    tds.eq(2).text(nickname);
                    tds.eq(3).text(tel);
                    //清空tds
                    $('#myModal').removeData('tds'); //为什么要清空
                }
            });
            //修改
            $(".main").on('click', ".edit", function() {
                var tds = $(this).parent().parent().find("td");
                // var name, nickname, tel, address, number, brand, tp;
                // let arr = [name, nickname, tel, address, number, brand, tp]
                // for (let i = 0; i < arr.length; i++) {
                //     console.log(tds.eq(i).text())
                // }
                // var name, nickname, tel, address, number, brand, tp;
                // let arr = {
                //         name: tds.eq(1).text(),
                //         nickname: tds.eq(2).text(),
                //         tel: tds.eq(2).text(),
                //         address: tds.eq(2).text(),
                //         number: tds.eq(2).text(),
                //         brand: tds.eq(2).text(),
                //         tp: tds.eq(2).text()
                //     }
                var name = tds.eq(1).text();
                var nickname = tds.eq(2).text();
                var tel = tds.eq(3).text();
                var address = tds.eq(4).text();
                var number = tds.eq(5).text();
                var brand = tds.eq(6).text();
                var tp = tds.eq(7).text();
                $('#name').val(name);
                console.log($('#name').val());
                $('#nickname').val(nickname);
                $('#tel').val(tel);
                $('#address').val(address);
                $('#number').val(number);
                $('#brand').val(brand);
                $('#tp').val(tp);
                $('#myModal').modal('show');

                /*   把tds保存到myModal的data$(selector).data(name,value)   name	必需。规定要设置的数据的名称。 value	必需。规定要设置的数据的值。  */
                $('#myModal').data({
                    'tds': tds
                });
            });
        })
    </script>

</body>

</html>